<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gener√°tor test≈Ø - CHEMIE 1. roƒçn√≠k</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { 
      font-family: Arial, sans-serif; 
      background-color: #667eea;
      padding: 24px;
    }
    .container { max-width: 800px; margin: 0 auto; }
    .card { 
      background-color: white;
      background-image: 
        url("data:image/svg+xml,%3Csvg width='120' height='120' viewBox='0 0 120 120' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23f9a8d4' fill-opacity='0.15'%3E%3Ccircle cx='60' cy='60' r='12'/%3E%3Ccircle cx='25' cy='25' r='8'/%3E%3Ccircle cx='95' cy='95' r='8'/%3E%3Ccircle cx='25' cy='95' r='6'/%3E%3Ccircle cx='95' cy='25' r='6'/%3E%3C/g%3E%3Cg stroke='%23f9a8d4' stroke-width='2' fill='none' stroke-opacity='0.12'%3E%3Cpath d='M35 60 Q47 40 60 60 T85 60'/%3E%3Ccircle cx='60' cy='60' r='20'/%3E%3C/g%3E%3C/svg%3E");
      border-radius: 16px; 
      box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); 
      padding: 32px; 
      margin-bottom: 24px; 
    }
    h1 { 
      font-size: 28px; 
      font-weight: bold; 
      color: #1f2937; 
      margin-bottom: 24px; 
      text-align: center; 
    }
    .info-box { 
      background: #fef3c7; 
      border-radius: 8px; 
      padding: 16px; 
      margin-bottom: 24px; 
    }
    .info-box p { font-size: 14px; color: #374151; line-height: 1.6; }
    .form-group { margin-bottom: 16px; }
    label { 
      display: block; 
      font-size: 14px; 
      font-weight: 500; 
      color: #374151; 
      margin-bottom: 8px; 
    }
    input[type="text"], input[type="date"], input[type="number"], select {
      width: 100%;
      padding: 10px 12px;
      border: 2px solid #d1d5db;
      border-radius: 8px;
      outline: none;
      font-size: 14px;
    }
    select {
      cursor: pointer;
      background: white;
    }
    .input-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }
    .btn {
      padding: 14px 40px;
      border-radius: 8px;
      font-weight: 600;
      border: none;
      cursor: pointer;
      box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
      font-size: 16px;
      width: 100%;
      margin-top: 8px;
    }
    .btn-primary {
      background: linear-gradient(to right, #ec4899, #f43f5e);
      color: white;
    }
    .btn-secondary {
      background: linear-gradient(to right, #6b7280, #4b5563);
      color: white;
      margin-top: 16px;
    }
    .btn:disabled {
      background: #d1d5db;
      cursor: not-allowed;
    }
    .warning {
      background: #fef3c7;
      border: 2px solid #fbbf24;
      border-radius: 8px;
      padding: 12px;
      margin-top: 16px;
    }
    .warning p { color: #92400e; font-size: 14px; text-align: center; }
    .success {
      background: #d1fae5;
      border: 2px solid #10b981;
      border-radius: 8px;
      padding: 16px;
      margin: 16px 0;
    }
    .success p { color: #065f46; font-size: 14px; }
    .instruction-box {
      background: #fef3c7;
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
    }
    .instruction-box p {
      font-size: 14px;
      color: #92400e;
      line-height: 1.5;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <h1>üß™ Gener√°tor test≈Ø z CHEMIE - 1. roƒçn√≠k</h1>
      
      <div class="info-box" id="infoBox">
        <p><strong>Jak to funguje:</strong><br>
        1. Vyber t≈ô√≠du<br>
        2. Klikni "Vygenerovat v≈°echny testy"<br>
        3. St√°hne se JEDEN soubor se V≈†EMI testy (ka≈æd√Ω student jin√© ot√°zky)<br>
        4. Vytiskni a rozdej student≈Øm</p>
      </div>

      <div class="form-group">
        <label>T≈ô√≠da:</label>
        <select id="className">
          <option value="">-- Vyber t≈ô√≠du --</option>
          <option value="1.A">1.A</option>
          <option value="1.B">1.B</option>
          <option value="5KA">5KA</option>
        </select>
      </div>

      <div class="input-row">
        <div class="form-group">
          <label>Poƒçet student≈Ø:</label>
          <input type="number" id="studentCount" value="30" min="1" max="50">
        </div>
        
        <div class="form-group">
          <label>Datum testu:</label>
          <input type="date" id="testDate">
        </div>
      </div>

      <div class="input-row">
        <div class="form-group">
          <label>Ot√°zek na test:</label>
          <input type="number" id="questionsPerTest" value="30" min="1" max="50">
        </div>
        
        <div class="form-group">
          <label>Bod≈Ø za ot√°zku:</label>
          <input type="number" id="pointsPerQuestion" value="1" min="1" max="10">
        </div>
      </div>

      <button class="btn btn-primary" onclick="generateAllTests()">
        Vygenerovat v≈°echny testy najednou
      </button>

      <button class="btn btn-secondary" onclick="window.location.href='index.html'">
        ‚Üê Zpƒõt na rozcestn√≠k
      </button>

      <div id="warningSection" style="display: none;">
        <div class="warning">
          <p id="warningText">Vypl≈à v≈°echny √∫daje</p>
        </div>
      </div>

      <div id="successSection" style="display: none;">
        <div class="success">
          <p><strong>‚úÖ Testy vygenerov√°ny!</strong><br>
          Soubor obsahuje <span id="testInfo"></span> test≈Ø p≈ôipraven√Ωch k tisku.</p>
        </div>
      </div>

      <div class="instruction-box" style="margin-top: 24px;">
        <p><strong>üí° Tip:</strong> Ka≈æd√Ω student dostane jin√© ot√°zky (n√°hodnƒõ vybran√© z datab√°ze). 
        Testy jsou v jednom souboru, ka≈æd√Ω test na samostatn√©m listu. Staƒç√≠ vytisknout a rozdat student≈Øm.</p>
      </div>
    </div>
  </div>

  <script>
    const questionsDatabase = {
      "Z√°kladn√≠ pojmy": [
        { q: "Co je chemick√Ω prvek?", a: "L√°tka slo≈æen√° z atom≈Ø se stejn√Ωm protonov√Ωm ƒç√≠slem" },
        { q: "Co je slouƒçenina?", a: "L√°tka slo≈æen√° z atom≈Ø dvou nebo v√≠ce prvk≈Ø v pevn√©m pomƒõru" },
        { q: "Co je atom?", a: "Nejmen≈°√≠ ƒç√°stice prvku schopn√° samostatn√© existence" },
        { q: "Co je protonov√© ƒç√≠slo (Z)?", a: "Poƒçet proton≈Ø v j√°d≈ôe atomu; urƒçuje prvek" },
        { q: "Co je nukleonov√© ƒç√≠slo (A)?", a: "Souƒçet proton≈Ø a neutron≈Ø v j√°d≈ôe atomu" },
        { q: "Co je molekula?", a: "Skupina dvou nebo v√≠ce atom≈Ø spojen√Ωch chemickou vazbou" },
        { q: "Co je ion?", a: "Elektricky nabit√° ƒç√°stice vznikl√° ztr√°tou nebo p≈ôijet√≠m elektron≈Ø" },
        { q: "Co je kation?", a: "Kladnƒõ nabit√Ω ion (ztr√°c√≠ elektrony)" },
        { q: "Co je anion?", a: "Z√°pornƒõ nabit√Ω ion (p≈ôij√≠m√° elektrony)" },
        { q: "Co je chemicky ƒçist√° l√°tka?", a: "L√°tka slo≈æen√° z ƒç√°stic stejn√©ho druhu" },
        { q: "Co je homogenn√≠ smƒõs?", a: "Smƒõs, kter√° m√° v cel√©m objemu stejn√© slo≈æen√≠ (nap≈ô. roztok)" },
        { q: "Co je heterogenn√≠ smƒõs?", a: "Smƒõs, kde lze slo≈æky rozli≈°it (nap≈ô. p√≠sek a voda)" }
      ],
      "Metody dƒõlen√≠ smƒõs√≠": [
        { q: "Co je filtrace?", a: "Oddƒõlov√°n√≠ pevn√© l√°tky od kapaliny pomoc√≠ filtru" },
        { q: "Co je destilace?", a: "Oddƒõlov√°n√≠ kapalin podle rozd√≠ln√Ωch bod≈Ø varu" },
        { q: "Co je krystalizace?", a: "Vyluƒçov√°n√≠ pevn√© l√°tky z roztoku p≈ôi ochlazov√°n√≠ nebo odpa≈ôov√°n√≠" },
        { q: "Co je sublimace?", a: "P≈ôemƒõna pevn√© l√°tky p≈ô√≠mo na plyn" }
      ],
      "Kvantitativn√≠ chemie": [
        { q: "Co je l√°tkov√© mno≈æstv√≠ (n)?", a: "Poƒçet ƒç√°stic l√°tky, jednotka mol" },
        { q: "Co je Avogadrova konstanta (N‚Çê)?", a: "Poƒçet ƒç√°stic v 1 molu (6,022√ó10¬≤¬≥ mol‚Åª¬π)" },
        { q: "Co je mol√°rn√≠ hmotnost (M)?", a: "Hmotnost 1 molu l√°tky (g/mol)" },
        { q: "Co je mol√°rn√≠ objem (V‚Çò)?", a: "Objem 1 molu plynu za norm√°ln√≠ch podm√≠nek (22,4 dm¬≥/mol)" },
        { q: "Co je hmotnostn√≠ zlomek (w)?", a: "Pomƒõr hmotnosti slo≈æky k celkov√© hmotnosti smƒõsi" },
        { q: "Co je objemov√Ω zlomek (œÜ)?", a: "Pomƒõr objemu slo≈æky k celkov√©mu objemu smƒõsi" },
        { q: "Co je mol√°rn√≠ koncentrace (c)?", a: "Poƒçet mol≈Ø l√°tky rozpu≈°tƒõn√Ωch v 1 litru roztoku" }
      ],
      "Modely atomu a radioaktivita": [
        { q: "Co je Thomson≈Øv model atomu?", a: "Atom jako pudink - kladn√° koule s rozpt√Ωlen√Ωmi elektrony" },
        { q: "Co je Rutherford≈Øv model atomu?", a: "Atom m√° mal√© kladn√© j√°dro, kolem nƒõj ob√≠haj√≠ elektrony" },
        { q: "Co je Bohr≈Øv model atomu?", a: "Elektrony ob√≠haj√≠ j√°dro po p≈ôesnƒõ dan√Ωch drah√°ch (energetick√Ωch hladin√°ch)" },
        { q: "Co je nuklid?", a: "Atomy t√©ho≈æ prvku se stejn√Ωm protonov√Ωm i nukleonov√Ωm ƒç√≠slem" },
        { q: "Co je izotop?", a: "Atomy t√©ho≈æ prvku s r≈Øzn√Ωm poƒçtem neutron≈Ø" },
        { q: "Co je radioaktivita?", a: "Samovoln√Ω rozpad jader za uvolnƒõn√≠ z√°≈ôen√≠" },
        { q: "Co je p≈ôirozen√° radioaktivita?", a: "Samovoln√Ω rozpad jader nestabiln√≠ch nuklid≈Ø v p≈ô√≠rodƒõ" },
        { q: "Co je umƒõl√° radioaktivita?", a: "Radioaktivita vyvolan√° z√°sahem ƒçlovƒõka (nap≈ô. oza≈ôov√°n√≠m stabiln√≠ch jader)" },
        { q: "Co je alfa z√°≈ôen√≠?", a: "Tvo≈ôeno ƒç√°sticemi He¬≤‚Å∫ (2 protony + 2 neutrony); m√° malou pronikavost" },
        { q: "Co je beta z√°≈ôen√≠?", a: "Proud elektron≈Ø nebo pozitron≈Ø; st≈ôedn√≠ pronikavost" },
        { q: "Co je gama z√°≈ôen√≠?", a: "Elektromagnetick√© z√°≈ôen√≠ s vysokou energi√≠; velmi pronikav√©" },
        { q: "Co je ≈°tƒõpen√≠ jader?", a: "Rozpad tƒõ≈æk√Ωch jader na dvƒõ men≈°√≠, uvol≈àuje velk√© mno≈æstv√≠ energie" }
      ],
      "Kvantov√° ƒç√≠sla a orbitaly": [
        { q: "Co je atomov√Ω orbital?", a: "Prostor, kde je nejvƒõt≈°√≠ pravdƒõpodobnost v√Ωskytu elektronu" },
        { q: "Jak√Ω je tvar orbitalu s?", a: "Kulov√Ω tvar, pojme max. 2 elektrony" },
        { q: "Jak√Ω je tvar orbitalu p?", a: "Tvar osmiƒçky, pojme max. 6 elektron≈Ø (ve 3 orbitalech)" },
        { q: "Co urƒçuje hlavn√≠ kvantov√© ƒç√≠slo (n)?", a: "Urƒçuje energetickou hladinu elektronu" },
        { q: "Co urƒçuje vedlej≈°√≠ kvantov√© ƒç√≠slo (l)?", a: "Urƒçuje tvar orbitalu (0 = s, 1 = p, 2 = d, 3 = f)" },
        { q: "Co urƒçuje magnetick√© kvantov√© ƒç√≠slo (m)?", a: "Urƒçuje orientaci orbitalu v prostoru" },
        { q: "Co vyjad≈ôuje spinov√© ƒç√≠slo (s)?", a: "Vyjad≈ôuje smƒõr rotace elektronu (+¬Ω nebo ‚àí¬Ω)" },
        { q: "Co ≈ô√≠k√° Pauliho princip?", a: "V jednom orbitalu mohou b√Ωt max. 2 elektrony s opaƒçn√Ωm spinem" },
        { q: "Co ≈ô√≠k√° Hundovo pravidlo?", a: "Elektrony zapl≈àuj√≠ orbitaly tak, aby jich bylo co nejv√≠ce nep√°rov√Ωch" }
      ],
      "Chemick√© vazby": [
        { q: "Co je chemick√° vazba?", a: "S√≠la dr≈æ√≠c√≠ atomy pohromadƒõ v molekule" },
        { q: "Co je d√©lka vazby?", a: "Vzd√°lenost mezi j√°dry dvou v√°zan√Ωch atom≈Ø" },
        { q: "Co je energie vazby?", a: "Energie pot≈ôebn√° k roz≈°tƒõpen√≠ vazby" },
        { q: "Co je jednoduch√° vazba?", a: "Sd√≠l√≠ 1 elektronov√Ω p√°r (vazba sigma)" },
        { q: "Co je dvojn√° vazba?", a: "Sd√≠l√≠ 2 elektronov√© p√°ry (jedna vazba sigma, 1 vazba p√≠)" },
        { q: "Co je trojn√° vazba?", a: "Sd√≠l√≠ 3 elektronov√© p√°ry (jedna vazba sigma, 2 vazby p√≠)" },
        { q: "Co je kovalentn√≠ vazba?", a: "Sd√≠len√≠ elektron≈Ø mezi nekovov√Ωmi atomy" },
        { q: "Co je kovov√° vazba?", a: "Sd√≠len√≠ elektron≈Ø mezi kovov√Ωmi atomy, vznik√° elektronov√Ω oblak" },
        { q: "Co je vod√≠kov√Ω m≈Østek?", a: "Slab√° vazba mezi vod√≠kem a elektronegativn√≠m atomem (nap≈ô. O, N, F)" },
        { q: "Co jsou Van der Waalsovy s√≠ly?", a: "Slab√© p≈ôita≈æliv√© s√≠ly mezi molekulami" }
      ],
      "Chemick√© reakce": [
        { q: "Co jsou reaktanty?", a: "L√°tky vstupuj√≠c√≠ do chemick√© reakce" },
        { q: "Co jsou produkty?", a: "L√°tky vznikaj√≠c√≠ v chemick√© reakci" },
        { q: "Co je chemick√° rovnice?", a: "Z√°pis chemick√© reakce pomoc√≠ znaƒçek a vzorc≈Ø" },
        { q: "Co je synt√©za?", a: "Spojov√°n√≠ jednodu≈°≈°√≠ch l√°tek na slo≈æitƒõj≈°√≠" },
        { q: "Co je anal√Ωza?", a: "Rozklad slo≈æitƒõj≈°√≠ l√°tky na jednodu≈°≈°√≠" },
        { q: "Co je adice?", a: "P≈ôipojen√≠ atomu nebo skupiny na n√°sobnou vazbu" },
        { q: "Co je eliminace?", a: "Od≈°tƒõpen√≠ atomu nebo skupiny a vznik n√°sobn√© vazby" },
        { q: "Co je substituce?", a: "Nahrazen√≠ atomu nebo skupiny jin√Ωm atomem nebo skupinou" }
      ],
      "Rychlost reakc√≠ a rovnov√°ha": [
        { q: "Co ≈ô√≠k√° sr√°≈ækov√° teorie?", a: "Reakce prob√≠h√° jen p≈ôi dostateƒçnƒõ energick√© sr√°≈æce ƒç√°stic" },
        { q: "Co je aktivovan√Ω komplex?", a: "Nestabiln√≠ p≈ôechodn√Ω stav bƒõhem reakce" },
        { q: "Co je rychlost reakce?", a: "Zmƒõna koncentrace l√°tky za jednotku ƒçasu" },
        { q: "Co je katalyz√°tor?", a: "L√°tka, kter√° urychluje reakci, ale sama se p≈ôitom nespot≈ôebuje" },
        { q: "Co je exotermick√° reakce?", a: "Reakce, p≈ôi n√≠≈æ se uvol≈àuje teplo (ŒîH < 0)" },
        { q: "Co je endotermick√° reakce?", a: "Reakce, p≈ôi n√≠≈æ se teplo spot≈ôebov√°v√° (ŒîH > 0)" },
        { q: "Co je chemick√° rovnov√°ha?", a: "Stav, kdy rychlost p≈ô√≠m√© a zpƒõtn√© reakce je stejn√°" },
        { q: "Co je rovnov√°≈æn√° konstanta (K)?", a: "Vyjad≈ôuje pomƒõr koncentrac√≠ produkt≈Ø a reaktant≈Ø v rovnov√°ze" }
      ],
      "Redoxn√≠ reakce": [
        { q: "Co je oxidace?", a: "Ztr√°ta elektron≈Ø, zv√Ω≈°en√≠ oxidaƒçn√≠ho ƒç√≠sla" },
        { q: "Co je redukce?", a: "P≈ôijet√≠ elektron≈Ø, sn√≠≈æen√≠ oxidaƒçn√≠ho ƒç√≠sla" },
        { q: "Co je redox reakce?", a: "Souƒçasnƒõ prob√≠h√° oxidace a redukce" },
        { q: "Co je Beketovova ≈ôada?", a: "≈òazen√≠ kov≈Ø podle jejich schopnosti se oxidovat" }
      ],
      "Kyseliny a z√°sady": [
        { q: "Co je kyselina podle Br√∏nsteda?", a: "L√°tka, kter√° odevzd√°v√° proton (H‚Å∫)" },
        { q: "Co je z√°sada podle Br√∏nsteda?", a: "L√°tka, kter√° proton p≈ôij√≠m√°" },
        { q: "Co je konjugovan√Ω p√°r?", a: "Kyselina a z√°sada li≈°√≠c√≠ se o jeden proton" },
        { q: "Co je pH?", a: "M√≠ra kyselosti roztoku (‚àílog[H‚Å∫])" },
        { q: "Jak√© je pH siln√© kyseliny?", a: "pH < 3, √∫pln√° disociace" },
        { q: "Jak√© je pH siln√© z√°sady?", a: "pH > 11, √∫pln√° disociace" }
      ],
      "Periodick√° tabulka": [
        { q: "Co ≈ô√≠k√° periodick√Ω z√°kon?", a: "Vlastnosti prvk≈Ø se periodicky opakuj√≠ podle protonov√©ho ƒç√≠sla" },
        { q: "Co je perioda?", a: "≈ò√°dek v periodick√© tabulce, poƒçet elektronov√Ωch vrstev" },
        { q: "Co je skupina?", a: "Sloupec v tabulce, prvky se stejn√Ωm poƒçtem valenƒçn√≠ch elektron≈Ø" }
      ],
      "Vod√≠k a kysl√≠k": [
        { q: "Jak√© jsou vlastnosti, vyu≈æit√≠ a v√Ωskyt vod√≠ku?", a: "Bezbarv√Ω plyn, ho≈ôlav√Ω, tvo≈ô√≠ vodu; vyu≈æit√≠ v chem. pr≈Ømyslu, palivo" },
        { q: "Jak√© jsou slouƒçeniny vod√≠ku?", a: "H‚ÇÇO, NH‚ÇÉ, CH‚ÇÑ, HCl - ƒçast√© hydridy nekov≈Ø" },
        { q: "Jak√© jsou vlastnosti, vyu≈æit√≠ a v√Ωskyt kysl√≠ku?", a: "Bezbarv√Ω plyn, podporuje ho≈ôen√≠; vyu≈æit√≠ v medic√≠nƒõ a pr≈Ømyslu; ve vzduchu a ve vodƒõ" }
      ],
      "Alkalick√© kovy a kovy alkalick√Ωch zemin": [
        { q: "Jak√© jsou vlastnosti, vyu≈æit√≠ a v√Ωskyt alkalick√Ωch kov≈Ø?", a: "Velmi reaktivn√≠, mƒõkk√©, tvo≈ô√≠ z√°sadit√© oxidy; vyu≈æit√≠ v chemii a bateri√≠ch" },
        { q: "Jak√© jsou slouƒçeniny Na a K?", a: "NaCl, NaOH, Na‚ÇÇCO‚ÇÉ, KNO‚ÇÉ - d≈Øle≈æit√© soli a z√°sady" },
        { q: "Jak√© jsou vlastnosti, vyu≈æit√≠ a v√Ωskyt kov≈Ø alkalick√Ωch zemin?", a: "Reaktivn√≠, tvo≈ô√≠ z√°sadit√© oxidy; nap≈ô. Ca, Mg, vyu≈æit√≠ v pr≈Ømyslu" },
        { q: "Jak√© jsou vlastnosti, vyu≈æit√≠ a v√Ωskyt v√°pn√≠ku (Ca)?", a: "St≈ô√≠b≈ôit√Ω kov, ve v√°penci a k≈ô√≠dƒõ, nutn√Ω pro stavbu kost√≠; vyu≈æit√≠ ve stavebnictv√≠" }
      ]
    };

    // Spoƒç√≠tat celkov√Ω poƒçet ot√°zek
    const totalQuestions = Object.values(questionsDatabase).reduce((sum, section) => sum + section.length, 0);
    
    // Nastavit dne≈°n√≠ datum
    document.getElementById('testDate').value = new Date().toISOString().split('T')[0];
    
    // Aktualizovat info box s poƒçtem ot√°zek
    document.getElementById('infoBox').innerHTML = `<p><strong>Jak to funguje:</strong><br>
      1. Vyber t≈ô√≠du<br>
      2. Zadej poƒçet student≈Ø a poƒçet ot√°zek<br>
      3. Klikni "Vygenerovat v≈°echny testy"<br>
      4. St√°hne se JEDEN soubor se V≈†EMI testy (ka≈æd√Ω student jin√© ot√°zky)<br>
      5. Vytiskni a rozdej student≈Øm<br><br>
      <strong>‚ú® V datab√°zi je ${totalQuestions} ot√°zek z chemie pro 1. roƒçn√≠k</strong></p>`;

    function generateOneTest(numberOfQuestions) {
      const sections = Object.keys(questionsDatabase);
      const totalSections = sections.length;
      const questionsPerSection = Math.floor(numberOfQuestions / totalSections);
      const remainder = numberOfQuestions % totalSections;

      let selected = [];

      sections.forEach((section, index) => {
        const sectionQuestions = [...questionsDatabase[section]];
        const count = questionsPerSection + (index < remainder ? 1 : 0);
        
        for (let i = sectionQuestions.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [sectionQuestions[i], sectionQuestions[j]] = [sectionQuestions[j], sectionQuestions[i]];
        }
        
        const selectedFromSection = sectionQuestions.slice(0, Math.min(count, sectionQuestions.length));
        selectedFromSection.forEach(q => {
          selected.push({ ...q, section });
        });
      });

      for (let i = selected.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [selected[i], selected[j]] = [selected[j], selected[i]];
      }

      return selected;
    }

    function generateAllTests() {
      const className = document.getElementById('className').value;
      const studentCount = parseInt(document.getElementById('studentCount').value) || 30;
      const testDate = document.getElementById('testDate').value;
      const questionsPerTest = parseInt(document.getElementById('questionsPerTest').value) || 30;
      const pointsPerQuestion = parseInt(document.getElementById('pointsPerQuestion').value) || 1;

      if (!className) {
        document.getElementById('warningText').textContent = 'Vyber t≈ô√≠du';
        document.getElementById('warningSection').style.display = 'block';
        return;
      }

      document.getElementById('warningSection').style.display = 'none';

      const maxPoints = questionsPerTest * pointsPerQuestion;

      let content = `<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
    @media print {
      .test-page { page-break-after: always; break-after: page; }
      .test-page:last-child { page-break-after: auto; }
    }
    @media screen {
      .test-page { border-bottom: 3px solid #999; margin-bottom: 30px; padding-bottom: 20px; }
      .test-page:last-child { border-bottom: none; }
    }
    body { font-family: Arial; font-size: 9pt; line-height: 1.15; margin: 0.5cm; }
    h1 { text-align: center; font-size: 14pt; margin: 4px 0; }
    .header { border-top: 1.5px solid black; border-bottom: 1.5px solid black; padding: 3px 0; margin: 5px 0 8px 0; }
    .header p { margin: 1.5px 0; font-size: 9pt; }
    .question { border-bottom: 1px solid #ddd; padding: 1px 0; margin: 0; page-break-inside: avoid; break-inside: avoid; }
    .question-text { font-weight: bold; margin: 0 0 1px 0; font-size: 9pt; }
    .answer-field { min-height: 3.2em; border: none; padding: 2px 3px; background: transparent; margin: 0 0 1px 0; }
    .points { text-align: right; font-weight: bold; color: #c00; font-size: 8pt; margin: 0; }
    .summary { border: 1.5px solid black; padding: 8px; margin: 8px 0 8px 0; page-break-inside: avoid; break-inside: avoid; }
    .summary h2 { font-size: 11pt; margin: 0 0 5px 0; }
    .summary p { margin: 3px 0; font-size: 9pt; }
  </style>
</head>
<body>`;

      for (let studentNum = 1; studentNum <= studentCount; studentNum++) {
        if (studentNum > 1) {
          content += '<br clear=all style="page-break-before:always">';
        }

        const questions = generateOneTest(questionsPerTest);

        content += `
  <h1>TEST Z CHEMIE - 1. ROƒåN√çK</h1>
  <div class="header">
    <p><strong>Jm√©no a p≈ô√≠jmen√≠:</strong></p>
    <p><strong>T≈ô√≠da:</strong> ${className}</p>
    <p><strong>Datum:</strong> ${testDate}</p>
    <p><strong>Varianta:</strong> ${studentNum}</p>
  </div>`;

        questions.forEach((item, index) => {
          content += `
  <table style="width: 100%; border-collapse: collapse; page-break-inside: avoid;">
    <tr>
      <td>
        <div class="question">
          <p class="question-text">${index + 1}. ${item.q}</p>
          <div class="answer-field">&nbsp;</div>
          <p class="points">Bod≈Ø: _____</p>
        </div>
      </td>
    </tr>
  </table>`;
        });

        content += `
  <div class="summary">
    <h2>HODNOCEN√ç</h2>
    <p><strong>Celkem bod≈Ø:</strong> __________ / ${maxPoints}</p>
    <p><strong>Zn√°mka:</strong> __________</p>
    <p><strong>Koment√°≈ô uƒçitele:</strong></p>
    <div style="border: 1px solid #ccc; min-height: 50px; margin-top: 6px; background: #fafafa;"></div>
  </div>`;
      }

      content += `
</body>
</html>`;

      const blob = new Blob([content], { type: 'application/msword' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = 'testy_chemie_1rocnik_' + className.replace(/\s+/g, '_') + '_' + testDate + '.doc';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);

      document.getElementById('testInfo').textContent = studentCount + ' (CHEMIE 1. roƒçn√≠k)';
      document.getElementById('successSection').style.display = 'block';
    }
  </script>
</body>
</html>
